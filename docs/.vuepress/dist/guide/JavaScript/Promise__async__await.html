<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.60">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>promise/async/await | lxblog</title><meta name="description" content="记录学习笔记的博客">
    <link rel="preload" href="/assets/style-144f141d.css" as="style"><link rel="stylesheet" href="/assets/style-144f141d.css">
    <link rel="modulepreload" href="/assets/app-e6f53920.js"><link rel="modulepreload" href="/assets/framework-375afed4.js"><link rel="modulepreload" href="/assets/Promise__async__await.html-52e68a03.js"><link rel="modulepreload" href="/assets/Promise__async__await.html-0c591c24.js"><link rel="prefetch" href="/assets/index.html-185f117f.js" as="script"><link rel="prefetch" href="/assets/flex布局.html-8ddf20ab.js" as="script"><link rel="prefetch" href="/assets/Scss模块化导入.html-805271c6.js" as="script"><link rel="prefetch" href="/assets/浮动定位.html-00b69d9c.js" as="script"><link rel="prefetch" href="/assets/cookie-localStorage-sessionStorage.html-e217fc03.js" as="script"><link rel="prefetch" href="/assets/KeepAlive.html-fce9f296.js" as="script"><link rel="prefetch" href="/assets/pinia使用教程.html-d26b1caa.js" as="script"><link rel="prefetch" href="/assets/vueRouter.html-d1d278bc.js" as="script"><link rel="prefetch" href="/assets/vuex.html-5d2e319f.js" as="script"><link rel="prefetch" href="/assets/导航守卫.html-4437770b.js" as="script"><link rel="prefetch" href="/assets/组件.html-1d7e11b2.js" as="script"><link rel="prefetch" href="/assets/React基础.html-d2fc3c1b.js" as="script"><link rel="prefetch" href="/assets/Redux.html-4163c22f.js" as="script"><link rel="prefetch" href="/assets/defineProperty.html-5482805e.js" as="script"><link rel="prefetch" href="/assets/es6.html-f01f0020.js" as="script"><link rel="prefetch" href="/assets/js作用域.html-d2a7437a.js" as="script"><link rel="prefetch" href="/assets/js执行机制.html-7e4ed385.js" as="script"><link rel="prefetch" href="/assets/this指向.html-b9cd8af3.js" as="script"><link rel="prefetch" href="/assets/回流和重绘.html-4d3c17bf.js" as="script"><link rel="prefetch" href="/assets/字符串API.html-a051afe0.js" as="script"><link rel="prefetch" href="/assets/对象API.html-b4484c2f.js" as="script"><link rel="prefetch" href="/assets/数组API.html-63bffeee.js" as="script"><link rel="prefetch" href="/assets/深拷贝和浅拷贝.html-06ff887c.js" as="script"><link rel="prefetch" href="/assets/防抖和节流.html-c98c28b2.js" as="script"><link rel="prefetch" href="/assets/404.html-f9875e7b.js" as="script"><link rel="prefetch" href="/assets/index.html-53e75ca6.js" as="script"><link rel="prefetch" href="/assets/flex布局.html-407ec235.js" as="script"><link rel="prefetch" href="/assets/Scss模块化导入.html-282c1773.js" as="script"><link rel="prefetch" href="/assets/浮动定位.html-d973e3ff.js" as="script"><link rel="prefetch" href="/assets/cookie-localStorage-sessionStorage.html-ba6ee78f.js" as="script"><link rel="prefetch" href="/assets/KeepAlive.html-aa04a755.js" as="script"><link rel="prefetch" href="/assets/pinia使用教程.html-33a52af2.js" as="script"><link rel="prefetch" href="/assets/vueRouter.html-d5371af3.js" as="script"><link rel="prefetch" href="/assets/vuex.html-5ee9dc46.js" as="script"><link rel="prefetch" href="/assets/导航守卫.html-fe72a12c.js" as="script"><link rel="prefetch" href="/assets/组件.html-0acfbeef.js" as="script"><link rel="prefetch" href="/assets/React基础.html-b886d17e.js" as="script"><link rel="prefetch" href="/assets/Redux.html-ae35cf16.js" as="script"><link rel="prefetch" href="/assets/defineProperty.html-4fa20e21.js" as="script"><link rel="prefetch" href="/assets/es6.html-494f1e63.js" as="script"><link rel="prefetch" href="/assets/js作用域.html-10951083.js" as="script"><link rel="prefetch" href="/assets/js执行机制.html-ae68a9b6.js" as="script"><link rel="prefetch" href="/assets/this指向.html-f8120780.js" as="script"><link rel="prefetch" href="/assets/回流和重绘.html-a0e8fec8.js" as="script"><link rel="prefetch" href="/assets/字符串API.html-e9a5cee5.js" as="script"><link rel="prefetch" href="/assets/对象API.html-1445edb3.js" as="script"><link rel="prefetch" href="/assets/数组API.html-0b5ea1ac.js" as="script"><link rel="prefetch" href="/assets/深拷贝和浅拷贝.html-6f4a7700.js" as="script"><link rel="prefetch" href="/assets/防抖和节流.html-b72a8733.js" as="script"><link rel="prefetch" href="/assets/404.html-d64b09f8.js" as="script"><link rel="prefetch" href="/assets/Test-0c7e545e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/images/logo.jpg" alt="lxblog"><span class="site-name can-hide">lxblog</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/" class="sidebar-item sidebar-heading" aria-label="首页"><!--[--><!--]--> 首页 <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">HTML&amp;CSS <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/guide/HTML_CSS/flex%E5%B8%83%E5%B1%80.html" class="sidebar-item" aria-label="flex布局"><!--[--><!--]--> flex布局 <!--[--><!--]--></a><!----></li><li><a href="/guide/HTML_CSS/Scss%E6%A8%A1%E5%9D%97%E5%8C%96%E5%AF%BC%E5%85%A5.html" class="sidebar-item" aria-label="SCSS模块化引入"><!--[--><!--]--> SCSS模块化引入 <!--[--><!--]--></a><!----></li><li><a href="/guide/HTML_CSS/%E6%B5%AE%E5%8A%A8%E5%AE%9A%E4%BD%8D.html" class="sidebar-item" aria-label="浮动定位"><!--[--><!--]--> 浮动定位 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">JavaScript <span class="down arrow"></span></p><ul style="" class="sidebar-item-children"><!--[--><li><a href="/guide/JavaScript/%E5%AF%B9%E8%B1%A1API.html" class="sidebar-item" aria-label="对象API"><!--[--><!--]--> 对象API <!--[--><!--]--></a><!----></li><li><a href="/guide/JavaScript/%E6%95%B0%E7%BB%84API.html" class="sidebar-item" aria-label="数组API"><!--[--><!--]--> 数组API <!--[--><!--]--></a><!----></li><li><a href="/guide/JavaScript/%E5%AD%97%E7%AC%A6%E4%B8%B2API.html" class="sidebar-item" aria-label="字符串API"><!--[--><!--]--> 字符串API <!--[--><!--]--></a><!----></li><li><a href="/guide/JavaScript/%E9%98%B2%E6%8A%96%E5%92%8C%E8%8A%82%E6%B5%81.html" class="sidebar-item" aria-label="防抖和节流"><!--[--><!--]--> 防抖和节流 <!--[--><!--]--></a><!----></li><li><a href="/guide/JavaScript/%E5%9B%9E%E6%B5%81%E5%92%8C%E9%87%8D%E7%BB%98.html" class="sidebar-item" aria-label="回流和重绘"><!--[--><!--]--> 回流和重绘 <!--[--><!--]--></a><!----></li><li><a href="/guide/JavaScript/%E6%B7%B1%E6%8B%B7%E8%B4%9D%E5%92%8C%E6%B5%85%E6%8B%B7%E8%B4%9D.html" class="sidebar-item" aria-label="深拷贝和浅拷贝"><!--[--><!--]--> 深拷贝和浅拷贝 <!--[--><!--]--></a><!----></li><li><a href="/guide/JavaScript/es6.html" class="sidebar-item" aria-label="Es6常用"><!--[--><!--]--> Es6常用 <!--[--><!--]--></a><!----></li><li><a href="/guide/JavaScript/js%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6.html" class="sidebar-item" aria-label="js执行机制"><!--[--><!--]--> js执行机制 <!--[--><!--]--></a><!----></li><li><a href="/guide/JavaScript/js%E4%BD%9C%E7%94%A8%E5%9F%9F.html" class="sidebar-item" aria-label="js作用域"><!--[--><!--]--> js作用域 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html" class="router-link-active router-link-exact-active router-link-active sidebar-item active" aria-label="promise/async/await"><!--[--><!--]--> promise/async/await <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html#_1-什么是promise" class="router-link-active router-link-exact-active sidebar-item" aria-label="1:什么是Promise"><!--[--><!--]--> 1:什么是Promise <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html#_2-promise的状态" class="router-link-active router-link-exact-active sidebar-item" aria-label="2：promise的状态"><!--[--><!--]--> 2：promise的状态 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html#_3-promise的基本流程" class="router-link-active router-link-exact-active sidebar-item" aria-label="3：Promise的基本流程"><!--[--><!--]--> 3：Promise的基本流程 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html#_4-基本使用" class="router-link-active router-link-exact-active sidebar-item" aria-label="4：基本使用"><!--[--><!--]--> 4：基本使用 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html#_5-promise-all" class="router-link-active router-link-exact-active sidebar-item" aria-label="5：Promise.all"><!--[--><!--]--> 5：Promise.all <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html#_6-promise-race" class="router-link-active router-link-exact-active sidebar-item" aria-label="6: Promise.race"><!--[--><!--]--> 6: Promise.race <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html#_7-async-await" class="router-link-active router-link-exact-active sidebar-item" aria-label="7:async/await"><!--[--><!--]--> 7:async/await <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html#async" class="router-link-active router-link-exact-active sidebar-item" aria-label="async"><!--[--><!--]--> async <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/guide/JavaScript/Promise__async__await.html#await" class="router-link-active router-link-exact-active sidebar-item" aria-label="await"><!--[--><!--]--> await <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><li><a href="/guide/JavaScript/defineProperty.html" class="sidebar-item" aria-label="Object.defineProperty"><!--[--><!--]--> Object.defineProperty <!--[--><!--]--></a><!----></li><li><a href="/guide/JavaScript/this%E6%8C%87%E5%90%91.html" class="sidebar-item" aria-label="This指向问题"><!--[--><!--]--> This指向问题 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Vue <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/guide/Vue/pinia%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B.html" class="sidebar-item" aria-label="pinia使用教程"><!--[--><!--]--> pinia使用教程 <!--[--><!--]--></a><!----></li><li><a href="/guide/Vue/%E5%AF%BC%E8%88%AA%E5%AE%88%E5%8D%AB.html" class="sidebar-item" aria-label="Vue导航守卫"><!--[--><!--]--> Vue导航守卫 <!--[--><!--]--></a><!----></li><li><a href="/guide/Vue/%E7%BB%84%E4%BB%B6.html" class="sidebar-item" aria-label="Vue组件"><!--[--><!--]--> Vue组件 <!--[--><!--]--></a><!----></li><li><a href="/guide/Vue/vueRouter.html" class="sidebar-item" aria-label="VueRouter"><!--[--><!--]--> VueRouter <!--[--><!--]--></a><!----></li><li><a href="/guide/Vue/vuex.html" class="sidebar-item" aria-label="Vuex"><!--[--><!--]--> Vuex <!--[--><!--]--></a><!----></li><li><a href="/guide/Vue/KeepAlive.html" class="sidebar-item" aria-label="KeepAlive"><!--[--><!--]--> KeepAlive <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">React <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/guide/React/React%E5%9F%BA%E7%A1%80.html" class="sidebar-item" aria-label="React基础"><!--[--><!--]--> React基础 <!--[--><!--]--></a><!----></li><li><a href="/guide/React/Redux.html" class="sidebar-item" aria-label="Redux使用"><!--[--><!--]--> Redux使用 <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="sidebar-item sidebar-heading collapsible">Http <span class="right arrow"></span></p><ul style="display:none;" class="sidebar-item-children"><!--[--><li><a href="/guide/Http/cookie-localStorage-sessionStorage.html" class="sidebar-item" aria-label="Cookie/LocalStorage/SessionStorage"><!--[--><!--]--> Cookie/LocalStorage/SessionStorage <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h2 id="_1-什么是promise" tabindex="-1"><a class="header-anchor" href="#_1-什么是promise" aria-hidden="true">#</a> 1:什么是Promise</h2><blockquote><p>promise是一个对象，它代表了一个异步操作的最终完成或者失败</p></blockquote><ul><li>从语法上来说：Promise 是一个构造函数</li><li>从功能上来说：Promise 对象用来封装一个异步操作并可以获取其结果</li></ul><h2 id="_2-promise的状态" tabindex="-1"><a class="header-anchor" href="#_2-promise的状态" aria-hidden="true">#</a> 2：promise的状态</h2><ol><li>pending 变为 resolved</li><li>pending 变为rejected</li></ol><blockquote><p>说明：只有这2种，且一个 Promise 对象只能改变一次，无论变成成功还是失败，都会有一个结果数据，成功的结果数据一般称为 value，失败的结果数据一般称为 reason。</p></blockquote><h2 id="_3-promise的基本流程" tabindex="-1"><a class="header-anchor" href="#_3-promise的基本流程" aria-hidden="true">#</a> 3：Promise的基本流程</h2><p><img src="https://p1-tt.byteimg.com/origin/pgc-image/35477690536b4e2baf57653c7026b0ac?from=pc" alt="「长文干货」Promise和Async/await的理解和使用"></p><h2 id="_4-基本使用" tabindex="-1"><a class="header-anchor" href="#_4-基本使用" aria-hidden="true">#</a> 4：基本使用</h2><p>返回0-10随机数大于5成功否则失败</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> p1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">//执行器函数同步执行</span>
  <span class="token comment">//2:执行异步操作</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> num <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">10</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">&gt;=</span> <span class="token number">5</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 3.1 如果成功了，调用resolve(value)</span>
      <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">&#39;成功&#39;</span> <span class="token operator">+</span> num<span class="token punctuation">)</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 3.2 如果失败了，调用reject(reason)</span>
    <span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">&#39;失败&#39;</span> <span class="token operator">+</span> num<span class="token punctuation">)</span>

  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
p1<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 接受得到成功的value数据，onResolved</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">rej</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 接受得到失败的reason数据,onRejected</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rej<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-promise-all" tabindex="-1"><a class="header-anchor" href="#_5-promise-all" aria-hidden="true">#</a> 5：Promise.all</h2><blockquote><p>包含 n 个 promise 的数组，返回一个新的 promise, 只有所有的 promise 都成功才成功, 只要有一个失败了就直接失败。</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>    <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">]</span>
    <span class="token keyword">const</span> list2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">]</span>
    <span class="token keyword">const</span> list3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">]</span>
    <span class="token keyword">const</span> p1 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> p2 <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>list2<span class="token punctuation">)</span>
    <span class="token keyword">const</span> p3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resove<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">resove</span><span class="token punctuation">(</span>list3<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> pll <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p1<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p3<span class="token punctuation">]</span><span class="token punctuation">)</span>
    pll<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token parameter">rej</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>rej<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> race <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p3<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p1<span class="token punctuation">]</span><span class="token punctuation">)</span>
    race<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><a href="https://imgse.com/i/ppZXOwF" target="_blank" rel="noopener noreferrer"><img src="https://s1.ax1x.com/2023/03/07/ppZXOwF.png" alt="ppZXOwF.png"><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_6-promise-race" tabindex="-1"><a class="header-anchor" href="#_6-promise-race" aria-hidden="true">#</a> 6: Promise.race</h2><blockquote><p>包含 n 个 promise 的数组，返回一个新的 promise, 第一个完成的 promise 的结果状态就是最终的结果状态。</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">const</span> race <span class="token operator">=</span> Promise<span class="token punctuation">.</span><span class="token function">race</span><span class="token punctuation">(</span><span class="token punctuation">[</span>p3<span class="token punctuation">,</span> p2<span class="token punctuation">,</span> p1<span class="token punctuation">]</span><span class="token punctuation">)</span>
race<span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//p2最先执行[4,5,6,7,8]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_7-async-await" tabindex="-1"><a class="header-anchor" href="#_7-async-await" aria-hidden="true">#</a> 7:async/await</h2><p><strong>async/await</strong> 实际上只是一种基于 <strong>promises</strong> 的语法糖，<strong>async/await</strong> 和 <strong>promises</strong> 一样，都是非堵塞式的，<strong>async/await</strong> 让异步代码更具同步代码风格，这也是其优势所在。</p><p><strong>async function</strong> 用来定义一个返回 <strong>AsyncFunction</strong> 对象的异步函数。异步函数是指通过事件循环异步执行的函数，它会通过一个隐式的 <strong>Promise</strong> 返回其结果，。如果你在代码中使用了异步函数，就会发现它的语法和结构会更像是标准的同步函数。</p><p><strong>await</strong> 操作符用于等待一个 <strong>Promise</strong> 对象。它只能在异步函数 <strong>async function</strong> 中使用。</p><h3 id="async" tabindex="-1"><a class="header-anchor" href="#async" aria-hidden="true">#</a> async</h3><blockquote><p><strong>async</strong> 函数的返回值为 Promise 对象，<strong>async</strong> 函数返回的 Promise 的结果由函数执行的结果决定</p></blockquote><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token comment">// Promise { 1 }</span>
<span class="token function">fn1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>
    <span class="token parameter">value</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onResolved()&#39;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token comment">//1</span>
    <span class="token parameter">reason</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;onRejected()&#39;</span><span class="token punctuation">,</span> reason<span class="token punctuation">)</span> <span class="token punctuation">}</span> 
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="await" tabindex="-1"><a class="header-anchor" href="#await" aria-hidden="true">#</a> await</h3><blockquote><p><strong>await</strong> 右侧的表达式一般为 <strong>promise</strong> 对象, 但也可以是其它的值</p><ol><li>如果表达式是 promise 对象, await 返回的是 promise 成功的值</li><li>如果表达式是其它值, 直接将此值作为 await 的返回值</li></ol></blockquote><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">fn4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token number">6</span>   
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// const value = await fn2() // await 右侧表达式为Promise，得到的结果就是Promise成功的value</span>
    <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fn4</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">fn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// value 6</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>await</strong> 必须写在 <strong>async</strong> 函数中, 但 <strong>async</strong> 函数中可以没有 <strong>await</strong>，如果 <strong>await</strong> 的 Promise 失败了, 就会抛出异常, 需要通过 <strong>try...catch</strong> 捕获处理。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token comment">// resolve(1000)</span>
            <span class="token function">reject</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fn2</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;得到失败的结果&#39;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token function">fn3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 得到失败的结果 1000</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Async/await 比 Promise 更优越的表现</strong></p><p><strong>简洁干净</strong>，使用 async/await 能省去写多少行代码</p><p><strong>错误处理</strong>，async/wait 能用相同的结构和好用的经典 try/catch 处理同步和异步错误，错误堆栈能指出包含错误的函数。</p><p><strong>调试</strong>，async/await 的一个极大优势是它更容易调试，使用 async/await 则无需过多箭头函数，并且能像正常的同步调用一样直接跨过 await 调用。</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: liangxiao@dv-email.com">liangxiao</span><!----><!--]--><!--]--></span></div></footer><nav class="page-nav"><p class="inner"><span class="prev"><a href="/guide/JavaScript/js%E4%BD%9C%E7%94%A8%E5%9F%9F.html" class="" aria-label="js作用域"><!--[--><!--]--> js作用域 <!--[--><!--]--></a></span><span class="next"><a href="/guide/JavaScript/defineProperty.html" class="" aria-label="Object.defineProperty"><!--[--><!--]--> Object.defineProperty <!--[--><!--]--></a></span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app-e6f53920.js" defer></script>
  </body>
</html>
